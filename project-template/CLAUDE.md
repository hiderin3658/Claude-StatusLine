# プロジェクト AI ガイド（[プロジェクト名]）

> 共通ルール（`~/.claude/CLAUDE.md`）に加えて、このプロジェクト固有のルールを定義します。
> 【注意】このファイルは `.claude/CLAUDE.md` に配置してください。

---

## 外部ファイル化ガイドライン

**このファイルは200行以内を目標**にしてください。詳細な内容は外部ファイルに分離し、参照リンクを記載します。

### 外部化すべき内容

| 内容 | 外部ファイル | 外部化の目安 |
|------|------------|-------------|
| 詳細なレビューチェックリスト | `docs/REVIEW_GUIDELINES.md` | 50行以上 |
| デプロイ手順の詳細 | `docs/DEPLOY.md` | コマンド例が10個以上 |
| API仕様書 | `docs/API.md` または OpenAPI yaml | エンドポイント5個以上 |
| 設計書・アーキテクチャ | `DESIGN.md` | 常に外部化推奨 |
| 統合ガイド | `docs/INTEGRATION_GUIDE.md` | 他システム連携がある場合 |

### CLAUDE.mdに残すべき内容

- **概要・要約**: 表形式で簡潔に
- **重要なルールのみ**: 箇条書き3-5項目程度
- **外部ファイルへの参照**: `> 詳細は docs/XXX.md を参照`
- **コード例**: 最小限（5行以内、パターンを示すのみ）

### 外部化の書き方

```markdown
## セクション名

> 詳細は `docs/DETAIL.md` を参照してください。

### 重要なポイントのみ記載

- ポイント1
- ポイント2
```

---

## 1. プロジェクト概要

| 項目 | 内容 |
|-----|------|
| **名前** | [プロジェクト名] |
| **概要** | [プロジェクトの簡潔な説明] |
| **主要機能** | [機能1]、[機能2]、[機能3] |
| **想定ユーザー** | [対象ユーザー層] |

---

## 2. 技術スタック

| カテゴリ | 技術 |
|---------|------|
| **言語** | [Python 3.x / TypeScript / etc.] |
| **フレームワーク** | [FastAPI / React / etc.] |
| **データベース** | [PostgreSQL / Firestore / etc.]（該当する場合） |
| **外部API** | [使用する外部サービス]（該当する場合） |
| **インフラ** | [Cloud Run / Vercel / etc.]（該当する場合） |

---

## 3. ディレクトリ構成

```
project-name/
├── src/                  # または app/
│   ├── [module1]/        # [用途]
│   ├── [module2]/        # [用途]
│   └── main.[ext]        # エントリポイント
├── tests/                # テストファイル
├── docs/                 # ドキュメント（オプション）
├── .claude/CLAUDE.md     # このファイル
├── [package.json / requirements.txt]
└── README.md
```

---

## 4. コーディング規約

### 4.1 基本ルール

- **型ヒント/型定義**: [すべての関数に付与 / TypeScript strict mode / etc.]
- **Docstring/JSDoc**: 公開関数には日本語で記述
- **命名規則**: [PascalCase / camelCase / snake_case の使い分け]
- **import順序**: 標準ライブラリ → サードパーティ → ローカルモジュール

### 4.2 フレームワーク特有パターン

| パターン | 用途 |
|---------|------|
| [パターン1] | [用途の説明] |
| [パターン2] | [用途の説明] |

<!--
例（FastAPI）:
| `Depends()` | 依存性注入 |
| `HTTPException` | 統一エラーレスポンス |

例（React）:
| `useState/useReducer` | 状態管理 |
| `useEffect` | 副作用処理 |
-->

---

## 5. 品質チェック

### 5.1 チェックコマンド

```bash
# リンター
[eslint src/ / flake8 app/ / etc.]

# フォーマッター
[prettier --check . / black --check app/ / etc.]

# 型チェック
[tsc --noEmit / mypy app/ / etc.]

# テスト
[npm test / pytest / etc.]
```

### 5.2 チェックフロー

```
実装完了 → リンター → 型チェック → テスト → セルフレビュー → 報告
```

---

## 6. エラーハンドリング・ログ

### 6.1 必須ログポイント

| 処理 | レベル |
|------|--------|
| [重要な処理1] | INFO |
| [エラー処理1] | ERROR |
| [警告が必要な処理] | WARNING |

### 6.2 ログ出力の注意

- **機密情報禁止**: APIキー、トークン、パスワードは絶対にログ出力しない
- **スタックトレース**: エラー時は詳細情報を含める

---

## 7. セキュリティ

### 7.1 機密情報管理

| 環境 | 設定場所 |
|------|---------|
| ローカル | `.env` ファイル（コミット禁止） |
| 本番 | [Secret Manager / 環境変数 / etc.] |

**禁止事項**: APIキーのハードコーディング、ログ出力

### 7.2 認証（該当する場合）

<!-- 認証フローがある場合は記述 -->
1. [認証ステップ1]
2. [認証ステップ2]
3. [認証ステップ3]

---

## 8. トラブルシューティング

| 問題 | 原因 | 解決策 |
|------|------|--------|
| [よくある問題1] | [原因] | [解決策] |
| [よくある問題2] | [原因] | [解決策] |

<!--
例:
| ModuleNotFoundError | パッケージ未インストール | `pip install -r requirements.txt` |
| CORS error | オリジン未許可 | `.env`の`CORS_ORIGINS`にURLを追加 |
-->

---

## 9. デプロイ（該当する場合）

> 詳細は `docs/DEPLOY.md` または `README.md` を参照してください。

### 重要な注意事項

<!-- Cloud Run の場合 -->
| オプション | 動作 | 使用可否 |
|-----------|------|---------|
| `--set-env-vars` | 既存をすべて上書き | **使用禁止** |
| `--update-env-vars` | 追加・更新のみ | 推奨 |

### 標準デプロイコマンド

```bash
# [デプロイコマンドを記入]
```

---

## 10. API利用制限（該当する場合）

| API | 制限 |
|-----|------|
| [API名1] | [制限内容] |
| [API名2] | [制限内容] |

---

## 11. 更新ポリシー

- 新機能追加時: セクション3, 4を更新
- 外部サービス追加時: セクション2を更新
- エラーパターン発見時: セクション8に追記

### 更新履歴

- YYYY-MM-DD: 初版作成
